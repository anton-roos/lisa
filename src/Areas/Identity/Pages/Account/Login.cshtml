@page
@model Lisa.Areas.Identity.Pages.Account.LoginModel
@{
  ViewData["Title"] = "Log in";
}

<div class="login-page">
  <div class="form">
    <img class="logo" src="~/images/logo.png" alt="DCEG Learn" />
    <p class="subtitle">Sign in to continue</p>

    <form id="account" method="post" novalidate>
        <div asp-validation-summary="ModelOnly" class="text-danger" role="alert"></div>

        <div class="field">
            <div class="input">
                <i class="bi bi-envelope"></i>
                <input asp-for="Input.Email"
                       placeholder="Email"
                       autocomplete="username"
                       inputmode="email"
                       autocapitalize="none"
                       spellcheck="false"
                       autofocus />
            </div>
            <span asp-validation-for="Input.Email" class="text-danger"></span>
        </div>

        <div class="field">
            <div class="input">
                <i class="bi bi-lock"></i>
                <input asp-for="Input.Password"
                       id="password"
                       placeholder="Pasword"
                       autocomplete="current-password"
                       enterkeyhint="go" />
                <button type="button" class="toggle" aria-label="Show password" onclick="togglePwd()">
                    <i class="bi bi-eye"></i>
                </button>
            </div>
            <span asp-validation-for="Input.Password" class="text-danger"></span>
        </div>

        <button id="loginBtn" type="submit" class="btn-primary">
            <span class="btn-text">Log in</span>
            <span class="spinner" aria-hidden="true"></span>
        </button>
    </form>
  </div>
</div>

@section Scripts {
  <partial name="_ValidationScriptsPartial" />
  <script>
    const btn = document.getElementById('loginBtn');
    const form = document.getElementById('account');

    form?.addEventListener('submit', () => {
      btn.classList.add('loading');
      btn.disabled = true;
    });

    function togglePwd(){
      const input = document.getElementById('password');
      const icon = event.currentTarget.querySelector('i');
      if (input.type === 'password'){
        input.type = 'text';
        icon.classList.replace('bi-eye','bi-eye-slash');
      } else {
        input.type = 'password';
        icon.classList.replace('bi-eye-slash','bi-eye');
      }
    }
  </script>
}
