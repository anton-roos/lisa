@page
@model Lisa.Areas.Identity.Pages.Account.RegisterModel
@{
    ViewData["Title"] = "Register";
    Layout = "/Pages/Shared/_IdentityLayout.cshtml";
}

<div class="login-page">
  <div class="form">
    <img class="logo" src="~/images/logo.png" alt="DCEG Learn" />
    <p class="subtitle">Create your account</p>

    <form id="registerForm" method="post" asp-route-returnUrl="@Model.ReturnUrl" novalidate>
        <div asp-validation-summary="ModelOnly" class="text-danger" role="alert"></div>

        <div class="field">
            <label asp-for="Input.Email"></label>
            <div class="input">
                <i class="bi bi-envelope"></i>
                <input asp-for="Input.Email"
                       autocomplete="username"
                       inputmode="email"
                       autocapitalize="none"
                       spellcheck="false" />
            </div>
            <span asp-validation-for="Input.Email" class="text-danger"></span>
        </div>

        <div class="field">
            <label asp-for="Input.Password"></label>
            <div class="input">
                <i class="bi bi-lock"></i>
                <input asp-for="Input.Password" id="password" autocomplete="new-password" />
                <button type="button" class="toggle" aria-label="Show password" onclick="togglePwd('password', this)">
                    <i class="bi bi-eye"></i>
                </button>
            </div>
            <span asp-validation-for="Input.Password" class="text-danger"></span>
        </div>

        <div class="field">
            <label asp-for="Input.ConfirmPassword"></label>
            <div class="input">
                <i class="bi bi-lock"></i>
                <input asp-for="Input.ConfirmPassword" id="confirmPassword" autocomplete="new-password" />
                <button type="button" class="toggle" aria-label="Show password" onclick="togglePwd('confirmPassword', this)">
                    <i class="bi bi-eye"></i>
                </button>
            </div>
            <span asp-validation-for="Input.ConfirmPassword" class="text-danger"></span>
        </div>

        <!-- Simple user type radios (plain HTML). 
             If you want this bound, add a property to RegisterModel.Input and rename name="Input.UserType". -->
        <div class="field">
            <label>User type</label>
            <div class="row" style="justify-content:flex-start; gap:1rem;">
                <label class="form-check">
                    <input class="form-check-input" type="radio" name="UserType" value="parent" checked>
                    <span class="form-check-label">Parent</span>
                </label>
                <label class="form-check">
                    <input class="form-check-input" type="radio" name="UserType" value="learner">
                    <span class="form-check-label">Learner</span>
                </label>
            </div>
        </div>

        <button id="registerBtn" type="submit" class="btn-primary">
            <span class="btn-text">Create account</span>
            <span class="spinner" aria-hidden="true"></span>
        </button>

        <p class="subtitle" style="margin-top:12px;">
            Already have an account? <a asp-page="./Login">Log in</a>
        </p>
    </form>
  </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
      const regBtn = document.getElementById('registerBtn');
      const regForm = document.getElementById('registerForm');

      regForm?.addEventListener('submit', () => {
        regBtn.classList.add('loading');
        regBtn.disabled = true;
      });

      function togglePwd(id, btn){
        const input = document.getElementById(id);
        const icon = btn.querySelector('i');
        if (input.type === 'password'){
          input.type = 'text';
          icon.classList.replace('bi-eye','bi-eye-slash');
        } else {
          input.type = 'password';
          icon.classList.replace('bi-eye-slash','bi-eye');
        }
      }
    </script>
}
